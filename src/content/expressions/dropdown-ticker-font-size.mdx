---
title: "Dropdown-Driven Ticker + Font Size"
description: "Pulls text from a master comp based on dropdown selection and applies dynamic font sizing. Works on 3D text layers."
dateAdded: "2024-12-30"
lastUpdated: "2024-12-30"
aeVersion: "17.0+"
expressionTypes:
  - text-routing
  - text-style
layerType: text
propertyType: source-text
complexity: 3
projects:
  - ussf-ticker
  - ussf-endcard
tags:
  - dropdown
  - font-size
  - createStyle
  - text-routing
  - 3d-text
code: |
  var layers = ["ticker:ussoccer", "ticker:usmnt", "ticker:uswnt"];
  var sizes  = [212, 203, 195];

  try {
    var idx = comp("Endcard_Master").layer("CONTROL").effect("Text")("Menu").value;
    idx = Math.max(1, Math.min(3, idx));
    
    var txt = comp("_MASTER").layer(layers[idx-1]).text.sourceText.value + "";
    
    text.sourceText.createStyle()
      .setFontSize(sizes[idx-1])
      .setText(txt);
      
  } catch (e) {
    value;
  }
annotations:
  - lines: "1-2"
    title: "Configuration Arrays"
    description: "Define the mapping between dropdown indices and layer names, plus the corresponding font sizes. The arrays are parallel—index 0 corresponds to dropdown value 1, etc."
  - lines: "4-6"
    title: "Read Dropdown Value"
    description: "Access the dropdown control from <code>Endcard_Master</code> comp → <code>CONTROL</code> layer → <code>Text</code> effect. The <code>(\"Menu\").value</code> returns the 1-based selection index. Clamping ensures it stays within valid range."
  - lines: "8"
    title: "Extract Text String"
    description: "Get the source text from the corresponding layer in <code>_MASTER</code> comp. The <code>+ \"\"</code> is critical—it coerces the TextDocument to a string. Using <code>.text</code> directly fails silently on some layer types."
  - lines: "10-12"
    title: "Apply Style and Return"
    description: "<code>createStyle()</code> creates a mutable TextStyle from the current layer's styling. <code>setFontSize()</code> overrides just the size while preserving font, tracking, etc. <code>setText()</code> applies the text and returns a valid TextDocument."
  - lines: "14-15"
    title: "Error Fallback"
    description: "If anything fails (missing comp, renamed layer, etc.), the expression falls back to <code>value</code>—the layer's current text—preventing blank output."
---

## Usage Notes

### Setup Requirements

1. **Master comp** (`_MASTER`) must contain text layers with exact names matching the `layers` array
2. **Control comp** (`Endcard_Master`) must have:
   - A null/solid layer named `CONTROL`
   - An effect called `Text` (Dropdown Menu Control)
3. The dropdown order must match the `layers` array order

### Key Discovery

The expression uses `sourceText.value + ""` instead of `sourceText.value.text` because:
- `.value.text` fails silently on 3D text layers
- String coercion (`+ ""`) reliably extracts the text content

### AE Version Requirement

Requires **After Effects 17.0+** (January 2020) for the `createStyle()` API. Check availability with:

```javascript
typeof text.sourceText.createStyle // should return "function"
```

### Customization

To add more options:
1. Add entries to both `layers` and `sizes` arrays
2. Update the dropdown in After Effects with matching options
3. Adjust the clamp max value: `Math.min(N, idx)` where N = number of options
